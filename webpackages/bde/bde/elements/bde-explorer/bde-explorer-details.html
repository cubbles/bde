<link rel="import" href="../../vendor/polymer/polymer.html">
<link rel="import" href="../../vendor/iron-collapse/iron-collapse.html">
<link rel="import" href="../../vendor/iron-icons/iron-icons.html">
<link rel="import" href="../../vendor/paper-dialog/paper-dialog.html">
<link rel="import" href="../../vendor/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../../vendor/paper-input/paper-input.html">
<link rel="import" href="../../vendor/paper-input/paper-textarea.html">
<link rel="import" href="../../vendor/paper-button/paper-button.html">
<link rel="import" href="../../vendor/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../vendor/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../custom-validator/custom-validator.html"/>


Polymer({

is: 'custom-validator',

behaviors: [
Polymer.IronValidatorBehavior
]
});
<dom-module id="bde-explorer-details">
    <template>
        <style>
            :host {
                display: block;
                z-index: 2;
            }

            paper-dialog {
                width: 45vw;
                top: 60px;
            }

            paper-checkbox {
                margin-top: 10px;
                margin-bottom: 10px;
                margin-right: 10px;
            }

            .collapse-content {
                padding: 10px;
            }

            .collapse-header {
                cursor: pointer;
                border: solid thin #dbdbdb;
                background-color: #dbdbdb;
                height: 24px;
            }

            .collapse-header span {
                padding: 10px;
            }

            .main-collapse-header {
                font-size: medium;
                margin-top: 15px;
            }

            .main-collapse-body {
                background-color: #f2f2f2;
            }

            .list-item-container {
                border-style: solid;
                border-width: 1px;
                padding: 10px;
                border-color: #dbdbdb;
                margin-top: 10px;
            }

            .itemActionButton {
                margin-top: 0.2em;
                background-color: white;
            }

            .errorMessage {
                background: #EEEEEE;
                color: #DD2C00;
                padding: 20px;
            }

            .deleteButton {
                float: right;
                color: #404040;
                margin-right: 0.4em;
                height: 24px;
            }

            .collapse-item {
                border: solid thin #dbdbdb;
            }

            .item-body {
                background-color: white;
            }


            .label {
                margin-top: 0.7em;
            }

            .label label{
                color: #737373;
                font-size: 0.8em;
                transition: transform 0.25s, width 0.25s;
                -webkit-transition: -webkit-transform 0.25s, width 0.25s;
            }

            .category {
                margin-top: 1em;
            }
        </style>

        <paper-dialog id="dialog" opened="{{opened}}" on-iron-overlay-opened="dialogOpenHandler">

            <h2><span>[[_editingArtifact.artifactId]]</span></h2>

            <div class="errorMessage" hidden="[[validForm]]">Please correct the errors in the form</div>

            <paper-dialog-scrollable>
                <form is="iron-form" id="artifactForm" on-dom-change="_validateForm">
                    <!-- artifactId -->
                    <paper-input tabindex="-1"
                                 label="Artifact id"
                                 pattern="^[a-z0-9]+(-[a-z0-9]+)+$"
                                 placeholder="A name for this artifact - unique within the webpackage."
                                 required
                                 auto-validate
                                 error-message="The artifact id shoudld be lowercase and separated  by '-'. (e.g. 'my-artifact')"
                                 value="{{_editingArtifact.artifactId}}">
                    </paper-input>
                    <!-- description -->
                    <paper-textarea tabindex="-1"
                                    label="description"
                                    placeholder="Description of this artifact: responsibility, usage scenarios."
                                    value="{{_editingArtifact.description}}">
                    </paper-textarea>

                    <!-- runnables -->
                    <div tabindex="0"
                         on-tap="toggleCollapse"
                         data-collapse-id="runnablesCollapse"
                         class="main-collapse-header collapse-header">
                        <span title="Resources that are actually runnable in a user webbrowser.">Runnables</span>
                        <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                    </div>
                    <iron-collapse id="runnablesCollapse" class="collapse-item main-collapse-body">
                        <div class="collapse-content">
                            <template is="dom-repeat"
                                      id="runnables"
                                      items="{{_editingArtifact.runnables}}"
                                      as="runnable"
                                      on-dom-change="runnablesDomChanged"
                                      index-as="runnablei">
                                <div>
                                    <div tabindex="0"
                                         on-tap="toggleCollapse"
                                         class="collapse-header"
                                         data-collapse-id$="[[_idForCollapse(runnablei, 'runnable_')]]">
                                        <span>[[runnable.name]]</span>
                                        <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                                        <iron-icon icon="icons:delete"
                                                   class="deleteButton"
                                                   on-tap="removeItem"
                                                   data-path$="[[_createPath('runnables')]]"
                                                   data-item-index$="[[runnablei]]"></iron-icon>
                                    </div>
                                    <iron-collapse id$="[[_idForCollapse(runnablei, 'runnable_')]]">
                                        <div class="collapse-content collapse-item item-body">
                                            <paper-input label="Name"
                                                         placeholder="A (short) name for the runnable."
                                                         pattern="^(.)+$"
                                                         required
                                                         auto-validate
                                                         error-message="The runnable name is required. (e.g. 'demo')"
                                                         value="{{runnable.name}}">
                                            </paper-input>
                                            <paper-input label="Path"
                                                         placeholder="Path to the 'runnable' resource - relative to the webpackage itself (e.g. '/doc/index.html')."
                                                         pattern="^/(.)+$"
                                                         required
                                                         auto-validate
                                                         error-message="The runnable path is required. (e.g. '/doc/index.html')"
                                                         value="{{runnable.path}}">
                                            </paper-input>
                                            <paper-textarea label="Description"
                                                            placeholder="Short description of the runnable: short content description, target group etc."
                                                            value="{{runnable.label}}">
                                            </paper-textarea>
                                        </div>
                                    </iron-collapse>
                                </div>
                            </template>
                            <paper-button raised class="itemActionButton"
                                          on-tap="addNewItem"
                                          data-path$="[[_createPath('runnables')]]"
                                          data-item-name="runnable">
                                <iron-icon icon="icons:add" item-icon></iron-icon>
                                Add Runnable
                            </paper-button>
                        </div>
                    </iron-collapse>

                    <div hidden$="[[!_artifactIsCompound(artifact)]]">
                        <!--<template is="dom-if" if="[[artifactType]]">-->
                        <!-- endpoints -->
                        <div tabindex="0"
                             on-tap="toggleCollapse"
                             data-collapse-id="endpointsCollapse"
                             class="main-collapse-header collapse-header">
                            <span title="1..n endpoints other artifacts can refer to. A 'main' -artifactEndpoint is required.">Endpoints</span>
                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                        </div>
                        <iron-collapse id="endpointsCollapse" class="collapse-item main-collapse-body">
                            <div class="collapse-content">
                                <template is="dom-repeat"
                                          id="endpoints"
                                          items="[[_editingArtifact.endpoints]]"
                                          index-as="endpointi"
                                          on-dom-change="endpointsDomChanged"
                                          as="endpoint">
                                    <div>
                                        <div tabindex="0"
                                             on-tap="toggleCollapse"
                                             class="collapse-header"
                                             data-collapse-id$="[[_idForCollapse(endpointi, 'endpoint_')]]">
                                            <span>[[endpoint.endpointId]]</span>
                                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                                            <iron-icon icon="icons:delete"
                                                       class="deleteButton"
                                                       on-tap="removeItem"
                                                       data-path$="[[_createPath('endpoints')]]"
                                                       data-item-index$="[[endpointi]]"></iron-icon>
                                        </div>
                                        <iron-collapse id$="[[_idForCollapse(endpointi, 'endpoint_')]]"
                                                       class="collapse-item">
                                            <div class="collapse-content collapse-item item-body">
                                                <paper-input label="Endpoint Id"
                                                             placeholder="Identifier for this slot item - unique within this component."
                                                             pattern="^[a-z0-9-]+$"
                                                             required
                                                             error-message="The endpoint id should be lowercase. It can contain numbers and '-'. (e.g. 'my-endpoint-1')"
                                                             auto-validate
                                                             value="{{endpoint.endpointId}}">
                                                </paper-input>
                                                <paper-textarea label="Description"
                                                                placeholder="Description of this endpoint: What does the endpoint provide? When to use? etc."
                                                                value="{{endpoint.description}}">
                                                </paper-textarea>

                                                <!-- endpoint resources -->
                                                <div tabindex="0"
                                                     on-tap="toggleCollapse"
                                                     class="collapse-header main-collapse-header "
                                                     data-collapse-id$="[[_idForCollapse(endpointi, 'endpoint_resources_')]]">
                                                    <span title="Contains the first-level resources of this endpoint.">Resources</span>
                                                    <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                                                </div>
                                                <iron-collapse
                                                        id="[[_idForCollapse(endpointi, 'endpoint_resources_')]]"
                                                        class="collapse-item">
                                                    <div class="collapse-content  main-collapse-body">
                                                        <template is="dom-repeat"
                                                                  id="resources"
                                                                  items="[[endpoint.resources]]"
                                                                  index-as="resourcei"
                                                                  data-endpoint-index$="[[endpointi]]"
                                                                  as="resource">
                                                            <div tabindex="0"
                                                                 class="collapse-header">
                                                                <span>&nbsp; </span>
                                                                <iron-icon icon="icons:delete"
                                                                           class="deleteButton"
                                                                           on-tap="removeItem"
                                                                           data-path$="[[_createPath('endpoints', endpointi, 'resources')]]"
                                                                           data-item-index$="[[resourcei]]"></iron-icon>
                                                            </div>
                                                            <template is="dom-if" if="[[_isObject(resource)]]">
                                                                <div class="collapse-content collapse-item item-body">
                                                                    <paper-input label="Development Path"
                                                                                 placeholder="Path to resource for development."
                                                                                 required
                                                                                 auto-validate
                                                                                 error-message="The path to the resource is required. (e.g. '/demo/index.html')"
                                                                                 value="{{resource.dev}}">
                                                                    </paper-input>
                                                                    <paper-input label="Production Path"
                                                                                 placeholder="Path to potentially optimized resource."
                                                                                 required
                                                                                 auto-validate
                                                                                 error-message="The path to the resource is required. It can be same as Development path. (e.g. '/demo/index.html')"
                                                                                 value="{{resource.prod}}">
                                                                    </paper-input>
                                                                </div>
                                                            </template>
                                                            <template is="dom-if" if="[[!_isObject(resource)]]">
                                                                <div class="collapse-content collapse-item item-body">
                                                                    <paper-input value="{{resource}}"
                                                                                 placeholder="Path to resource. This resource will be used for both runtimeMode 'prod' and 'dev'."
                                                                                 no-label-float>
                                                                    </paper-input>
                                                                </div>
                                                            </template>
                                                        </template>
                                                        <paper-button raised class="itemActionButton"
                                                                      on-tap="addNewItem"
                                                                      data-path$="[[_createPath('endpoints', endpointi, 'resources')]]"
                                                                      data-item-name="endpointResource">
                                                            <iron-icon icon="icons:add" item-icon></iron-icon>
                                                            <paper-item-body>
                                                                <div>Add Resource</div>
                                                            </paper-item-body>
                                                        </paper-button>
                                                    </div>
                                                </iron-collapse>

                                                <!-- endpoint dependencies -->
                                                <div tabindex="0"
                                                     on-tap="toggleCollapse"
                                                     class="main-collapse-header collapse-header"
                                                     data-collapse-id$="[[_idForCollapse(endpointi, 'endpoint_dependencies_')]]">
                                                    <span title="0..n other artifacts-endpoints this artifact-endpoint needs to work properly. Note: 'webpackage': 'this' refers artifact(s) of the this webpackage.">
                                                        Dependencies
                                                    </span>
                                                    <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                                                </div>
                                                <iron-collapse
                                                        id="[[_idForCollapse(endpointi, 'endpoint_dependencies_')]]">
                                                    <div class="collapse-content main-collapse-body">
                                                        <template is="dom-repeat"
                                                                  id="dependencies"
                                                                  is="dom-repeat"
                                                                  items="{{endpoint.dependencies}}"
                                                                  index-as="dependencyi"
                                                                  as="dependency">
                                                            <div tabindex="0"
                                                                 class="collapse-header">
                                                                <span>&nbsp; </span>
                                                                <iron-icon icon="icons:delete"
                                                                           class="deleteButton"
                                                                           on-tap="removeItem"
                                                                           data-path$="[[_createPath('endpoints', endpointi, 'dependencies')]]"
                                                                           data-item-index$="[[dependencyi]]"></iron-icon>
                                                            </div>
                                                            <div class="collapse-content collapse-item item-body">
                                                                <paper-input
                                                                        pattern="^[a-z0-9-@\.]+(-SNAPSHOT)?\/[a-z0-9-]+\/[a-z0-9-]+$"
                                                                        no-label-float
                                                                        auto-validate
                                                                        error-message="The dependecy should be: '[webpackageGroupId.]webpackageName@version/artifactId/endpointId' or 'this/artifactId/endpointId', (e.g. 'org.example.my-package@1.0/my-component/main' or 'this/my-component/main')"
                                                                        value="{{dependency}}">
                                                                </paper-input>
                                                            </div>
                                                        </template>
                                                        <paper-button raised class="itemActionButton"
                                                                      on-tap="addNewItem"
                                                                      data-path$="[[_createPath('endpoints', endpointi, 'dependencies')]]"
                                                                      data-item-name="endpointDependency">
                                                            <iron-icon icon="icons:add" item-icon></iron-icon>
                                                            Add Dependency
                                                        </paper-button>
                                                    </div>
                                                </iron-collapse>
                                            </div>
                                        </iron-collapse>
                                    </div>
                                </template>
                                <paper-button raised class="itemActionButton"
                                              on-tap="addNewItem"
                                              data-path$="[[_createPath('endpoints')]]"
                                              data-item-name="endpoint">
                                    <iron-icon icon="icons:add" item-icon></iron-icon>
                                    Add Endpoint</paper-item-body>
                                </paper-button>
                            </div>
                        </iron-collapse>

                        <!-- slots -->
                        <div tabindex="0"
                             on-tap="toggleCollapse"
                             data-collapse-id="slotsCollapse"
                             class="main-collapse-header collapse-header">
                            <span title="1..n slots to exchange data with other elementaries or compounds.">Slots</span>
                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                        </div>
                        <iron-collapse id="slotsCollapse" class="collapse-item main-collapse-body">
                            <div class="collapse-content">
                                <template is="dom-repeat"
                                          id="slots"
                                          items="[[_editingArtifact.slots]]"
                                          index-as="sloti"
                                          on-dom-change="slotsDomChanged"
                                          as="slot">
                                    <div>
                                        <div tabindex="0"
                                             on-tap="toggleCollapse"
                                             class="collapse-header"
                                             data-collapse-id$="[[_idForCollapse(sloti, 'slot_')]]">
                                            <span>[[slot.slotId]]</span>
                                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                                            <iron-icon icon="icons:delete"
                                                       class="deleteButton"
                                                       on-tap="removeItem"
                                                       data-path$="[[_createPath('slots')]]"
                                                       data-item-index$="[[sloti]]"></iron-icon>
                                        </div>
                                        <iron-collapse id$="[[_idForCollapse(sloti, 'slot_')]]">
                                            <div class="collapse-content collapse-item item-body">
                                                <paper-input label="Slot Id"
                                                             placeholder="Identifier for this slot item - unique within this component."
                                                             pattern="^[a-z][a-zA-Z0-9-]*$"
                                                             required
                                                             error-message="The slot id can contain letters, numbers or '-'. It should begin with a lowercase letter. (e.g. 'my-endpoint-1' or 'myEndpoint1')"
                                                             auto-validate
                                                             value="{{slot.slotId}}">
                                                </paper-input>
                                                <paper-input label="Type" list="slotTypes"
                                                             placeholder="Data type of the slot."
                                                             auto-validate
                                                             error-message="The slot type is required"
                                                             value="{{slot.type}}">
                                                </paper-input>
                                                <datalist id="slotTypes">
                                                    <option value="boolean"></option>
                                                    <option value="string"></option>
                                                    <option value="number"></option>
                                                    <option value="object"></option>
                                                    <option value="array"></option>
                                                </datalist>
                                                <paper-textarea label="Description"
                                                                placeholder="Description of this slot: responsibility, expected data-structure etc.">
                                                </paper-textarea>
                                                <div class="label">
                                                    <label class="label" title="A slot can be public accessible as input-slot (receive data), output-slot (propagate data) or both. If this attribute not exist, is the slot bidirectional">
                                                        Direction
                                                    </label>
                                                </div>
                                                <paper-checkbox checked="[[_isInputSlot(slot)]]">Input
                                                </paper-checkbox>
                                                <paper-checkbox checked="[[_isOutputSlot(slot)]]">Output
                                                </paper-checkbox>
                                            </div>
                                        </iron-collapse>
                                    </div>
                                </template>
                                <paper-button raised class="itemActionButton"
                                              on-tap="addNewItem"
                                              data-path$="[[_createPath('slots')]]"
                                              data-item-name="slot">
                                    <iron-icon icon="icons:add" item-icon></iron-icon>
                                    Add Slot
                                </paper-button>
                            </div>
                        </iron-collapse>

                        <!-- members -->
                        <div tabindex="0"
                             on-tap="toggleCollapse"
                             data-collapse-id="membersCollapse"
                             class="main-collapse-header collapse-header">
                        <span title="Referenced components (elementaries or compounds) acting as members of this compound component.">
                            Members
                        </span>
                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                        </div>
                        <iron-collapse id="membersCollapse" class="collapse-item main-collapse-body">
                            <div class="collapse-content">
                                <template is="dom-repeat"
                                          id="members"
                                          items="[[_editingArtifact.members]]"
                                          index-as="memberi"
                                          on-dom-change="membersDomChanged"
                                          as="member">
                                    <div>
                                        <div tabindex="0"
                                             on-tap="toggleCollapse"
                                             class="collapse-header"
                                             data-collapse-id$="[[_idForCollapse(memberi, 'member_')]]">
                                            <span>[[member.memberId]]</span>
                                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                                            <iron-icon icon="icons:delete"
                                                       class="deleteButton"
                                                       on-tap="removeItem"
                                                       data-path$="[[_createPath('members')]]"
                                                       data-item-index$="[[memberi]]"></iron-icon>
                                        </div>
                                        <iron-collapse id$="[[_idForCollapse(memberi, 'member_')]]"
                                                       class="collapse-item item-body">
                                            <div class="collapse-content">
                                                <paper-input label="Member Id"
                                                             placeholder="Identifier for this member item - unique within this compound component."
                                                             pattern="^[a-z][a-zA-Z0-9-]*$"
                                                             required
                                                             error-message="The member id can contain letters, numbers or '-'. (e.g. 'my-member-1' or 'myMember1)"
                                                             auto-validate
                                                             value="{{member.memberId}}">
                                                </paper-input>
                                                <paper-input label="Component Id"
                                                             placeholder="Id of the component for this member item (e.g. 'org.example.my-package@1.0/artifact1')"
                                                             pattern="^(([a-z0-9]+|([a-z0-9]+[a-z0-9-][a-z0-9]+)*)(\.([a-z0-9]+|([a-z0-9]+[a-z0-9-][a-z0-9]+)*))*[@](\d+)(\.[\d]+)*(-SNAPSHOT)?|(this))\/([a-z0-9-]+)$"
                                                             required
                                                             auto-validate
                                                             error-message="The component id should follow the pattern: 'webpackageGroupId.webpackageName@version/artifactId' or 'this/artifactId'. (e.g. 'org.example.my-package@1.0/my-component' or 'this/my-component')"
                                                             value="{{member.componentId}}">
                                                </paper-input>
                                                <paper-textarea label="Description"
                                                                placeholder="Description of this member: responsibility, usage notes etc."
                                                                value="{{member.description}}">
                                                </paper-textarea>
                                                <paper-input label="Display Name"
                                                             placeholder="Display name of the referenced member for design view of the BDE"
                                                             value="{{member.displayName}}">
                                                </paper-input>
                                            </div>
                                        </iron-collapse>
                                    </div>
                                </template>
                                <paper-button raised class="itemActionButton"
                                              on-tap="addNewItem"
                                              data-path$="[[_createPath('members')]]"
                                              data-item-name="member">
                                    <iron-icon icon="icons:add" item-icon></iron-icon>
                                    Add Member
                                </paper-button>
                            </div>
                        </iron-collapse>

                        <!-- connections -->
                        <div tabindex="0"
                             on-tap="toggleCollapse"
                             data-collapse-id="connectionsCollapse"
                             class="main-collapse-header collapse-header">
                        <span title="List of designed connection between the members and between members and this compound component.">
                            Connections
                        </span>
                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                        </div>
                        <iron-collapse id="connectionsCollapse" class="collapse-item main-collapse-body">
                            <div class="collapse-content">
                                <template is="dom-repeat"
                                          id="connections"
                                          items="[[_editingArtifact.connections]]"
                                          index-as="connectioni"
                                          on-dom-change="connectionsDomChanged"
                                          as="connection">
                                    <div>
                                        <div tabindex="0" on-tap="toggleCollapse" class="collapse-header"
                                             data-collapse-id$="[[_idForCollapse(connectioni, 'connection_')]]">
                                            <span>[[connection.connectionId]]</span>
                                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                                            <iron-icon icon="icons:delete"
                                                       class="deleteButton"
                                                       on-tap="removeItem"
                                                       data-path$="[[_createPath('connections')]]"
                                                       data-item-index$="[[connectioni]]"></iron-icon>
                                        </div>
                                        <iron-collapse id$="[[_idForCollapse(connectioni, 'connection_')]]"
                                                       class="collapse-item item-body">
                                            <div class="collapse-content">
                                                <paper-input label="Connection Id"
                                                             placeholder="Identifier for this connection item - unique within this compound component."
                                                             pattern="^[a-z][a-zA-Z0-9-:]*$"
                                                             required
                                                             error-message="The connection id can contain letters, numbers, '-' or ':'. It should begin with a lowercase letter. (e.g. 'slot-a:slot-b')"
                                                             auto-validate
                                                             value="{{connection.connectionId}}">
                                                </paper-input>
                                                <paper-textarea label="Description"
                                                                placeholder="A short description of this connection: responsibility etc."
                                                                value="{{connection.description}}">
                                                </paper-textarea>
                                                <paper-textarea label="Hook Function"
                                                                placeholder="A function declaration as a string or a global function name. This function will called, before a connection destination model variable setted."
                                                                value="{{connection.hookFunction}}">
                                                </paper-textarea>
                                                <paper-checkbox
                                                        title="If repeatedValues is true, the same value consecutively will propagated, otherwise not. The default value is false."
                                                        checked="{{connection.repeatedValues}}">
                                                    Repeated Values
                                                </paper-checkbox>
                                                <paper-checkbox
                                                        title="Indicate to copy or not to copy the payload (inc case the payload is an object). true: make a copy, false: do not make a copy - pass by reference. (default == true)"
                                                        checked="{{_copyValue(connection)}}">
                                                    Copy Value
                                                </paper-checkbox>
                                                <div class="list-item-container">
                                                    <div class="category">
                                                        <strong>Source</strong>
                                                    </div>
                                                    <paper-input label="Member Id Reference"
                                                                 placeholder="The 'memberId' value of the member item, the slot belongs to. If the memberIdRef property is missed, it will connected with an own slot of the compound component."
                                                                 pattern="^[a-z][a-zA-Z0-9-]*$"
                                                                 error-message="The member id can contain letters, numbers or '-'. It should begin with a lowercase letter. (e.g. 'myMember')"
                                                                 auto-validate
                                                                 value="{{connection.source.memberIdRef}}">
                                                    </paper-input>
                                                    <paper-input label="Slot Name"
                                                                 placeholder="The name of the slot."
                                                                 required
                                                                 error-message="The slot name is required"
                                                                 auto-validate
                                                                 value="{{connection.source.slot}}">
                                                    </paper-input>
                                                    <div class="category">
                                                        <strong>Destination</strong>
                                                    </div>
                                                    <paper-input label="Member Id Reference"
                                                                 placeholder="The 'memberId' value of the member item, the slot belongs to. If the memberIdRef property is missed, it will connected with an own slot of the compound component."
                                                                 pattern="^[a-z][a-zA-Z0-9-]*$"
                                                                 error-message="The member id can contain letters, numbers or '-'. It should begin with a lowercase letter. (e.g. 'myMember')"
                                                                 auto-validate
                                                                 value="{{connection.destination.memberIdRef}}">
                                                    </paper-input>
                                                    <paper-input label="Slot"
                                                                 placeholder="The name of the slot."
                                                                 required
                                                                 error-message="The slot name is required"
                                                                 auto-validate
                                                                 value="{{connection.destination.slot}}">
                                                    </paper-input>
                                                </div>
                                            </div>
                                        </iron-collapse>
                                    </div>
                                </template>
                                <paper-button raised class="itemActionButton"
                                              on-tap="addNewItem"
                                              data-path$="[[_createPath('connections')]]"
                                              data-item-name="connection">
                                    <iron-icon icon="icons:add" item-icon></iron-icon>
                                    Add Connection
                                </paper-button>
                            </div>
                        </iron-collapse>

                        <!-- inits -->
                        <div tabindex="0"
                             on-tap="toggleCollapse"
                             data-collapse-id="initsCollapse"
                             class="main-collapse-header collapse-header">
                            <span title="List of slot initializations of the compound and member component(s).">Inits</span>
                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                        </div>
                        <iron-collapse id="initsCollapse" class="collapse-item main-collapse-body">
                            <div class="collapse-content">
                                <template is="dom-repeat"
                                          id="inits"
                                          items="[[_editingArtifact.inits]]"
                                          index-as="initi"
                                          on-dom-change="initsDomChanged"
                                          as="init">
                                    <div>
                                        <div tabindex="0" on-tap="toggleCollapse" class="collapse-header"
                                             data-collapse-id$="[[_idForCollapse(initi, 'init_')]]">
                                            <span>[[initi]]</span>
                                            <iron-icon icon="[[_calculateToggleIcon()]]"></iron-icon>
                                            <iron-icon icon="icons:delete"
                                                       class="deleteButton"
                                                       on-tap="removeItem"
                                                       data-path$="[[_createPath('inits')]]"
                                                       data-item-index$="[[initi]]"></iron-icon>
                                        </div>
                                        <iron-collapse id$="[[_idForCollapse(initi, 'init_')]]"
                                                       class="collapse-item item-body">
                                            <div class="collapse-content">
                                                <paper-input label="Member Id Reference"
                                                             placeholder="The 'memberId' value of the member item, the slot belongs to. If the property is missed, it refers to an own slot of the compound component."
                                                             pattern="^[a-z][a-zA-Z0-9-]*$"
                                                             error-message="The member id can contain letters, numbers or '-'. It should begin with a lowercase letter. (e.g. 'my-member-1' or 'myMember1')"
                                                             auto-validate
                                                             value="{{init.memberIdRef}}">
                                                </paper-input>
                                                <paper-input label="Slot Name"
                                                             placeholder="Name of the slot to be initialized."
                                                             required
                                                             auto-validate
                                                             error-message="The slot name is required"
                                                             value="{{init.slot}}">
                                                </paper-input>
                                                <custom-validator id="{{_initTextareaValidatorId(initi)}}"
                                                                  class="validJson"
                                                                  validator-name$="{{_initTextareaValidatorName(initi)}}"></custom-validator>
                                                <paper-textarea auto-validate
                                                                validator$="{{_initTextareaValidatorName(initi)}}"
                                                                label="Value"
                                                                id="{{_initTextareaId(initi)}}"
                                                                class="initValue"
                                                                placeholder="The value to init the slot with."
                                                                value="{{_serialize(init.value)}}"
                                                                data-path$="[[_initValueDataPath(initi)]]">
                                                </paper-textarea>

                                                <paper-textarea label="Description"
                                                                placeholder="A short description of this init item: responsibility etc."
                                                                value="{{init.description}}">
                                                </paper-textarea>
                                            </div>
                                        </iron-collapse>
                                    </div>
                                </template>
                                <paper-button raised class="itemActionButton"
                                              on-tap="addNewItem"
                                              data-path$="[[_createPath('inits')]]"
                                              data-item-name="init">
                                    <iron-icon icon="icons:add" item-icon></iron-icon>
                                    Add Init
                                </paper-button>
                            </div>
                        </iron-collapse>
                        <!--</template>-->
                    </div>

                    <template is="dom-if" if="[[_artifactIsElementary(artifact)]]">

                    </template>

                    <template is="dom-if" if="[[_artifactIsUtility(artifact)]]">

                    </template>

                    <template is="dom-if" if="[[_artifactIsApp(artifact)]]">

                    </template>
                </form>
            </paper-dialog-scrollable>

            <div class="buttons">
                <paper-button on-tap="validateAndSave">Save</paper-button>
                <paper-button dialog-dismiss>Cancel</paper-button>
            </div>
        </paper-dialog>


    </template>
    <script src="../../vendor/lodash/dist/lodash.min.js"></script>
    <script src="bde-explorer-details.js"></script>
</dom-module>
